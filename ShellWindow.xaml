<Window x:Class="PosPokemon.App.ShellWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="POS Pokémon TCG" Height="800" Width="1200"
        WindowStartupLocation="CenterScreen"
        WindowState="Maximized"
        Background="{StaticResource AppBackgroundColor}">

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Style="{StaticResource MainHeader}">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <StackPanel Grid.Column="0" Orientation="Horizontal">
                    <TextBlock Text="⚡" 
                             FontSize="{StaticResource FontSizeXLarge}" 
                             Foreground="{StaticResource HeaderAccentColor}" 
                             VerticalAlignment="Center" 
                             Margin="0,0,10,0"/>
                    <StackPanel>
                        <TextBlock Text="POS POKÉMON TCG" 
                                 FontSize="{StaticResource FontSizeLarge}"
                                 FontWeight="Bold"
                                 Foreground="{StaticResource HeaderTextColor}"/>
                        <TextBlock Text="Sistema de Punto de Venta" 
                                 FontSize="{StaticResource FontSizeSmall}"
                                 Foreground="{StaticResource HeaderSubtextColor}" 
                                 Margin="0,2,0,0"/>
                    </StackPanel>
                </StackPanel>

                <StackPanel Grid.Column="1" Orientation="Horizontal" VerticalAlignment="Center">
                    <Border Style="{StaticResource UserBadge}">
                        <StackPanel Orientation="Horizontal">
                            <TextBlock Text="👤" FontSize="18" Margin="0,0,8,0"/>
                            <TextBlock Text="{Binding CurrentUser.Username}" 
                                     Style="{StaticResource UsernameText}"/>
                            <TextBlock Text="{Binding CurrentUser.Role}" 
                                     Style="{StaticResource RoleText}"/>
                        </StackPanel>
                    </Border>

                    <Button Content="Cerrar Sesión" 
                            Style="{StaticResource LogoutButton}"
                            Command="{Binding LogoutCommand}"/>
                </StackPanel>
            </Grid>
        </Border>

        <!-- Content Area -->
        <Grid Grid.Row="1">
            <!-- Dashboard por defecto (cuando CurrentView es null) -->
            <ScrollViewer VerticalScrollBarVisibility="Auto">
                <ScrollViewer.Style>
                    <Style TargetType="ScrollViewer">
                        <Setter Property="Visibility" Value="Visible"/>
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding CurrentView}" Value="{x:Null}">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </ScrollViewer.Style>

                <Grid Margin="40,30">
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="Auto"/>
                    </Grid.RowDefinitions>

                    <!-- FILA 1: Ventas, Inventario, Historial, Clientes (4 cards) -->
                    <UniformGrid Grid.Row="0" Columns="4" Margin="0,0,0,30">

                        <!-- Card: Ventas -->
                        <Border Style="{StaticResource DashboardCard}" 
                                Background="{StaticResource CardSalesColor}" 
                                Margin="10"
                                MouseLeftButtonDown="Card_Sales_Click">
                            <StackPanel>
                                <Viewbox Style="{StaticResource CardIcon}">
                                    <Canvas Width="100" Height="100">
                                        <Path Fill="White" Data="M20,8h60v50H20z M25,13h50v40H25z M30,20h10v5H30z M45,20h10v5H45z M60,20h10v5H60z M30,30h40v3H30z M30,38h40v3H30z M30,46h40v3H30z M15,63h70v8H15z"/>
                                    </Canvas>
                                </Viewbox>
                                <TextBlock Style="{StaticResource CardTitle}" Text="VENTAS"/>
                                <TextBlock Style="{StaticResource CardSubtitle}" Text="Registrar nueva venta"/>
                            </StackPanel>
                        </Border>

                        <!-- Card: Inventario -->
                        <Border Style="{StaticResource DashboardCard}" 
                                Background="{StaticResource CardInventoryColor}" 
                                Margin="10"
                                MouseLeftButtonDown="Card_Inventory_Click">
                            <StackPanel>
                                <Viewbox Style="{StaticResource CardIcon}">
                                    <Canvas Width="100" Height="100">
                                        <Path Fill="White" Data="M15,20h25v25H15z M45,20h25v25H45z M15,50h25v25H15z M45,50h25v25H45z"/>
                                        <Path Fill="White" Opacity="0.7" Data="M20,25h15v2H20z M20,30h15v2H20z M50,25h15v2H50z M50,30h15v2H50z M20,55h15v2H20z M20,60h15v2H20z M50,55h15v2H50z M50,60h15v2H50z"/>
                                    </Canvas>
                                </Viewbox>
                                <TextBlock Style="{StaticResource CardTitle}" Text="INVENTARIO"/>
                                <TextBlock Style="{StaticResource CardSubtitle}" Text="Gestionar productos"/>
                            </StackPanel>
                        </Border>

                        <!-- Card: Historial de Ventas -->
                        <Border Style="{StaticResource DashboardCard}" 
                                Background="{StaticResource CardHistoryColor}" 
                                Margin="10"
                                MouseLeftButtonDown="Card_History_Click"
                                Visibility="{Binding IsAdmin, Converter={StaticResource BoolToVis}}">
                            <StackPanel>
                                <Viewbox Style="{StaticResource CardIcon}">
                                    <Canvas Width="100" Height="100">
                                        <Path Fill="White" Data="M20,15h60v8H20z M20,30h60v8H20z M20,45h60v8H20z M20,60h60v8H20z"/>
                                        <Ellipse Fill="White" Canvas.Left="25" Canvas.Top="18" Width="4" Height="4"/>
                                        <Ellipse Fill="White" Canvas.Left="25" Canvas.Top="33" Width="4" Height="4"/>
                                        <Ellipse Fill="White" Canvas.Left="25" Canvas.Top="48" Width="4" Height="4"/>
                                        <Ellipse Fill="White" Canvas.Left="25" Canvas.Top="63" Width="4" Height="4"/>
                                    </Canvas>
                                </Viewbox>
                                <TextBlock Style="{StaticResource CardTitle}" Text="HISTORIAL"/>
                                <TextBlock Style="{StaticResource CardSubtitle}" Text="Ventas registradas"/>
                            </StackPanel>
                        </Border>

                        <!-- ✅ Card: Clientes (MOVIDO AQUÍ) -->
                        <Border Style="{StaticResource DashboardCard}" 
                                Background="#2196F3"
                                Margin="10"
                                MouseLeftButtonDown="Card_Customers_Click"
                                Visibility="{Binding IsAdmin, Converter={StaticResource BoolToVis}}">
                            <StackPanel>
                                <Viewbox Style="{StaticResource CardIcon}">
                                    <Canvas Width="100" Height="100">
                                        <Ellipse Fill="White" Canvas.Left="35" Canvas.Top="20" Width="18" Height="18"/>
                                        <Path Fill="White" Data="M30,42 Q44,36 58,42 L58,60 L30,60 z"/>
                                        <Ellipse Fill="White" Canvas.Left="12" Canvas.Top="28" Width="15" Height="15" Opacity="0.8"/>
                                        <Path Fill="White" Opacity="0.8" Data="M8,45 Q20,40 32,45 L32,58 L8,58 z"/>
                                        <Ellipse Fill="White" Canvas.Left="60" Canvas.Top="28" Width="15" Height="15" Opacity="0.8"/>
                                        <Path Fill="White" Opacity="0.8" Data="M56,45 Q68,40 80,45 L80,58 L56,58 z"/>
                                    </Canvas>
                                </Viewbox>
                                <TextBlock Style="{StaticResource CardTitle}" Text="CLIENTES"/>
                                <TextBlock Style="{StaticResource CardSubtitle}" Text="Base de clientes"/>
                            </StackPanel>
                        </Border>
                    </UniformGrid>

                    <!-- FILA 2: Reportes, Usuarios, Descuentos, Configuración (4 cards) -->
                    <UniformGrid Grid.Row="1" Columns="4" Margin="0,0,0,30">

                        <!-- Card: Reportes -->
                        <Border Style="{StaticResource DashboardCard}" 
                                Background="{StaticResource CardReportsColor}" 
                                Margin="10"
                                MouseLeftButtonDown="Card_Reports_Click"
                                Visibility="{Binding IsAdmin, Converter={StaticResource BoolToVis}}">
                            <StackPanel>
                                <Viewbox Style="{StaticResource CardIcon}">
                                    <Canvas Width="100" Height="100">
                                        <Path Fill="White" Data="M20,70h60v5H20z M25,40v25h8V40z M45,30v35h8V30z M65,50v15h8V50z"/>
                                        <Path Fill="White" Opacity="0.7" Data="M28,20 L48,30 L68,25" StrokeThickness="3" Stroke="White"/>
                                    </Canvas>
                                </Viewbox>
                                <TextBlock Style="{StaticResource CardTitle}" Text="REPORTES"/>
                                <TextBlock Style="{StaticResource CardSubtitle}" Text="Análisis y estadísticas"/>
                            </StackPanel>
                        </Border>

                        <!-- Card: Usuarios -->
                        <Border Style="{StaticResource DashboardCard}" 
                                Background="{StaticResource CardUsersColor}" 
                                Margin="10"
                                MouseLeftButtonDown="Card_Users_Click"
                                Visibility="{Binding IsAdmin, Converter={StaticResource BoolToVis}}">
                            <StackPanel>
                                <Viewbox Style="{StaticResource CardIcon}">
                                    <Canvas Width="100" Height="100">
                                        <Ellipse Fill="White" Canvas.Left="30" Canvas.Top="20" Width="20" Height="20"/>
                                        <Path Fill="White" Data="M25,45 Q40,38 55,45 L55,65 L25,65 z"/>
                                        <Ellipse Fill="White" Canvas.Left="55" Canvas.Top="25" Width="16" Height="16" Opacity="0.7"/>
                                        <Path Fill="White" Opacity="0.7" Data="M52,43 Q64,38 76,43 L76,60 L52,60 z"/>
                                    </Canvas>
                                </Viewbox>
                                <TextBlock Style="{StaticResource CardTitle}" Text="USUARIOS"/>
                                <TextBlock Style="{StaticResource CardSubtitle}" Text="Gestionar empleados"/>
                            </StackPanel>
                        </Border>

                        <!-- Card: Descuentos -->
                        <Border Style="{StaticResource DashboardCard}" 
                                Background="#4CAF50"
                                Margin="10"
                                MouseLeftButtonDown="Card_Discounts_Click"
                                Visibility="{Binding IsAdmin, Converter={StaticResource BoolToVis}}">
                            <StackPanel>
                                <Viewbox Style="{StaticResource CardIcon}">
                                    <Canvas Width="100" Height="100">
                                        <Path Fill="White" Data="M20,30 L50,10 L80,30 L80,70 L50,90 L20,70 z"/>
                                        <Path Fill="White" Opacity="0.9" Data="M35,40 L65,40 L60,50 L70,50 L65,60 L35,60 L40,50 L30,50 z"/>
                                        <Ellipse Fill="White" Canvas.Left="45" Canvas.Top="25" Width="10" Height="10"/>
                                    </Canvas>
                                </Viewbox>
                                <TextBlock Style="{StaticResource CardTitle}" Text="DESCUENTOS"/>
                                <TextBlock Style="{StaticResource CardSubtitle}" Text="Campañas promocionales"/>
                            </StackPanel>
                        </Border>

                        <!-- Card: Configuración -->
                        <Border Style="{StaticResource DashboardCard}" 
                                Background="{StaticResource CardSettingsColor}" 
                                Margin="10"
                                MouseLeftButtonDown="Card_Settings_Click"
                                Visibility="{Binding IsAdmin, Converter={StaticResource BoolToVis}}">
                            <StackPanel>
                                <Viewbox Style="{StaticResource CardIcon}">
                                    <Canvas Width="100" Height="100">
                                        <Path Fill="White" Data="M50,30 L55,35 L60,30 L65,35 L70,40 L65,45 L70,50 L65,55 L60,60 L55,65 L50,60 L45,65 L40,60 L35,55 L30,50 L35,45 L30,40 L35,35 L40,30 L45,35 z M50,40 A10,10 0 1,1 50,60 A10,10 0 1,1 50,40"/>
                                    </Canvas>
                                </Viewbox>
                                <TextBlock Style="{StaticResource CardTitle}" Text="CONFIGURACIÓN"/>
                                <TextBlock Style="{StaticResource CardSubtitle}" Text="Ajustes del sistema"/>
                            </StackPanel>
                        </Border>
                    </UniformGrid>

                    <!-- FILA 3: Stats Cards -->
                    <Grid Grid.Row="2" Margin="10,20,10,20">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>

                        <Border Grid.Column="0" Style="{StaticResource StatCard}">
                            <StackPanel>
                                <TextBlock Style="{StaticResource StatEmoji}" Text="💰"/>
                                <TextBlock Style="{StaticResource StatLabel}" Text="Ventas Hoy"/>
                                <TextBlock Style="{StaticResource StatValue}" 
                                         Text="{Binding SalesToday, StringFormat='S/ {0:N2}'}"/>
                            </StackPanel>
                        </Border>

                        <Border Grid.Column="1" Style="{StaticResource StatCard}">
                            <StackPanel>
                                <TextBlock Style="{StaticResource StatEmoji}" Text="📦"/>
                                <TextBlock Style="{StaticResource StatLabel}" Text="Productos"/>
                                <TextBlock Style="{StaticResource StatValue}" 
                                         Text="{Binding TotalProducts}"/>
                            </StackPanel>
                        </Border>

                        <Border Grid.Column="2" Style="{StaticResource StatCard}">
                            <StackPanel>
                                <TextBlock Style="{StaticResource StatEmoji}" Text="🎴"/>
                                <TextBlock Style="{StaticResource StatLabel}" Text="Stock Bajo"/>
                                <TextBlock Style="{StaticResource StatValueDanger}" 
                                         Text="{Binding LowStockItems}"/>
                            </StackPanel>
                        </Border>

                        <Border Grid.Column="3" Style="{StaticResource StatCard}">
                            <StackPanel>
                                <TextBlock Style="{StaticResource StatEmoji}" Text="📈"/>
                                <TextBlock Style="{StaticResource StatLabel}" Text="Este Mes"/>
                                <TextBlock Style="{StaticResource StatValueSuccess}" 
                                         Text="{Binding SalesThisMonth, StringFormat='S/ {0:N2}'}"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                </Grid>
            </ScrollViewer>

            <!-- Content Control para las vistas cargadas dinámicamente -->
            <ContentControl Content="{Binding CurrentView}"/>
        </Grid>
    </Grid>
</Window>
