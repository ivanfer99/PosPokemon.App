<UserControl x:Class="PosPokemon.App.Views.ReportsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Background="{StaticResource AppBackgroundColor}">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Botón Volver -->
        <Button Grid.Row="0"
                Content="⬅️ Volver al Dashboard"
                HorizontalAlignment="Left"
                Height="40"
                Padding="15,0"
                Margin="0,0,0,15"
                Style="{StaticResource PrimaryButton}"
                Command="{Binding BackToDashboardCommand}"/>

        <!-- Header -->
        <Grid Grid.Row="1" Margin="0,0,0,20">
            <TextBlock Text="📊 Reportes"
                       FontSize="28"
                       FontWeight="Bold"
                       Foreground="{StaticResource PrimaryTextColor}"/>

            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="🔄 Cargar"
                        Height="45"
                        Padding="20,0"
                        Style="{StaticResource PrimaryButton}"
                        Command="{Binding LoadCommand}"/>
            </StackPanel>
        </Grid>

        <!-- Filtros -->
        <Border Grid.Row="2"
                Background="White"
                CornerRadius="12"
                Padding="20"
                Margin="0,0,0,15">
            <Border.Effect>
                <DropShadowEffect Color="{StaticResource ShadowColor}" Opacity="0.1" BlurRadius="10" ShadowDepth="2"/>
            </Border.Effect>

            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="15"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="15"/>
                    <ColumnDefinition Width="Auto"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <TextBlock Grid.Column="0" Text="Desde:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                <DatePicker Grid.Column="2"
                            Width="170"
                            Height="40"
                            SelectedDate="{Binding FromDate}"/>

                <TextBlock Grid.Column="4" Text="Hasta:" VerticalAlignment="Center" Margin="0,0,8,0"/>
                <DatePicker Grid.Column="5"
                            Width="170"
                            Height="40"
                            HorizontalAlignment="Left"
                            SelectedDate="{Binding ToDate}"/>
            </Grid>
        </Border>

        <!-- Contenido -->
        <Grid Grid.Row="3">
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="15"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Resumen -->
            <UniformGrid Grid.Row="0" Columns="3" Margin="0,0,0,10">
                <Border Background="White" CornerRadius="12" Padding="16" Margin="6">
                    <Border.Effect>
                        <DropShadowEffect Color="{StaticResource ShadowColor}" Opacity="0.08" BlurRadius="10" ShadowDepth="2"/>
                    </Border.Effect>
                    <StackPanel>
                        <TextBlock Text="Ventas" FontWeight="Bold" Foreground="{StaticResource PrimaryTextColor}" />
                        <TextBlock Text="{Binding SalesCount}" FontSize="26" FontWeight="Bold" Margin="0,6,0,0"/>
                    </StackPanel>
                </Border>

                <Border Background="White" CornerRadius="12" Padding="16" Margin="6">
                    <Border.Effect>
                        <DropShadowEffect Color="{StaticResource ShadowColor}" Opacity="0.08" BlurRadius="10" ShadowDepth="2"/>
                    </Border.Effect>
                    <StackPanel>
                        <TextBlock Text="Total Vendido" FontWeight="Bold" Foreground="{StaticResource PrimaryTextColor}" />
                        <TextBlock Text="{Binding TotalSales}" FontSize="26" FontWeight="Bold" Margin="0,6,0,0"/>
                    </StackPanel>
                </Border>

                <Border Background="White" CornerRadius="12" Padding="16" Margin="6">
                    <Border.Effect>
                        <DropShadowEffect Color="{StaticResource ShadowColor}" Opacity="0.08" BlurRadius="10" ShadowDepth="2"/>
                    </Border.Effect>
                    <StackPanel>
                        <TextBlock Text="Ticket Promedio" FontWeight="Bold" Foreground="{StaticResource PrimaryTextColor}" />
                        <TextBlock Text="{Binding AvgTicket}" FontSize="26" FontWeight="Bold" Margin="0,6,0,0"/>
                    </StackPanel>
                </Border>
            </UniformGrid>

            <Grid Grid.Row="2">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="15"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>

                <!-- Ventas por usuario -->
                <Border Grid.Column="0" Background="White" CornerRadius="12" Padding="12">
                    <Border.Effect>
                        <DropShadowEffect Color="{StaticResource ShadowColor}" Opacity="0.08" BlurRadius="10" ShadowDepth="2"/>
                    </Border.Effect>

                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <TextBlock Text="👤 Ventas por Usuario"
                                   FontSize="16"
                                   FontWeight="Bold"
                                   Margin="8,6"
                                   Foreground="{StaticResource PrimaryTextColor}"/>

                        <DataGrid Grid.Row="1"
                                  ItemsSource="{Binding SalesByUser}"
                                  AutoGenerateColumns="False"
                                  CanUserAddRows="False"
                                  IsReadOnly="True"
                                  HeadersVisibility="Column"
                                  GridLinesVisibility="None"
                                  BorderThickness="0"
                                  RowHeight="42">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="Usuario" Binding="{Binding Username}" Width="*"/>
                                <DataGridTextColumn Header="Ventas" Binding="{Binding SalesCount}" Width="110"/>
                                <DataGridTextColumn Header="Total" Binding="{Binding Total}" Width="140"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Border>

                <!-- Top productos -->
                <Border Grid.Column="2" Background="White" CornerRadius="12" Padding="12">
                    <Border.Effect>
                        <DropShadowEffect Color="{StaticResource ShadowColor}" Opacity="0.08" BlurRadius="10" ShadowDepth="2"/>
                    </Border.Effect>

                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>

                        <TextBlock Text="🔥 Top Productos"
                                   FontSize="16"
                                   FontWeight="Bold"
                                   Margin="8,6"
                                   Foreground="{StaticResource PrimaryTextColor}"/>

                        <DataGrid Grid.Row="1"
                                  ItemsSource="{Binding TopProducts}"
                                  AutoGenerateColumns="False"
                                  CanUserAddRows="False"
                                  IsReadOnly="True"
                                  HeadersVisibility="Column"
                                  GridLinesVisibility="None"
                                  BorderThickness="0"
                                  RowHeight="42">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="SKU" Binding="{Binding Sku}" Width="120"/>
                                <DataGridTextColumn Header="Nombre" Binding="{Binding Name}" Width="*"/>
                                <DataGridTextColumn Header="Qty" Binding="{Binding Qty}" Width="90"/>
                                <DataGridTextColumn Header="Total" Binding="{Binding Total}" Width="140"/>
                            </DataGrid.Columns>
                        </DataGrid>
                    </Grid>
                </Border>
            </Grid>
        </Grid>
    </Grid>
</UserControl>

